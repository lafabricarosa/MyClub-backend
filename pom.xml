<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd">

    <modelVersion>4.0.0</modelVersion>

    <parent>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-parent</artifactId>
        <version>3.5.7</version>
        <relativePath />
    </parent>

    <groupId>com.gestiondeportiva</groupId>
    <artifactId>api</artifactId>
    <version>0.0.1-SNAPSHOT</version>
    <name>api</name>
    <description>Proyecto Spring Boot - Gesti√≥n Deportiva</description>

    <!-- ===================== -->
    <!-- üîß PROPIEDADES -->
    <!-- ===================== -->
    <properties>
        <java.version>21</java.version>
        <maven.compiler.source>${java.version}</maven.compiler.source>
        <maven.compiler.target>${java.version}</maven.compiler.target>
        <mapstruct.version>1.5.5.Final</mapstruct.version>
    </properties>

    <!-- ===================== -->
    <!-- üì¶ DEPENDENCIAS -->
    <!-- ===================== -->
    <dependencies>
        <!--
            üåê SPRING BOOT STARTER WEB
            Proporciona todo lo necesario para crear APIs REST:
            - Spring MVC para controllers REST
            - Tomcat embebido como servidor HTTP
            - Jackson para serializaci√≥n/deserializaci√≥n JSON
            - Manejo autom√°tico de peticiones HTTP (GET, POST, PUT, DELETE)
        -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-web</artifactId>
        </dependency>

        <!--
            üíæ SPRING DATA JPA + HIBERNATE
            Capa de persistencia para acceso a base de datos:
            - JPA (Java Persistence API) para mapeo objeto-relacional
            - Hibernate como implementaci√≥n JPA
            - Repositorios Spring Data para consultas autom√°ticas (findById, findAll, etc.)
            - Gesti√≥n autom√°tica de transacciones
            Usado en: UsuarioRepository, EquipoRepository, EstadisticaRepository, etc.
        -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-data-jpa</artifactId>
        </dependency>

        <!--
            üìä SPRING BOOT ACTUATOR
            Endpoints de monitorizaci√≥n y m√©tricas para producci√≥n:
            - /actuator/health: Estado de salud de la aplicaci√≥n
            - /actuator/info: Informaci√≥n sobre la aplicaci√≥n
            - /actuator/metrics: M√©tricas de rendimiento
            √ötil para DevOps y monitorizaci√≥n en producci√≥n
        -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-actuator</artifactId>
        </dependency>

        <!--
            ‚úÖ SPRING BOOT STARTER VALIDATION
            Validaci√≥n de datos de entrada usando anotaciones:
            - @NotNull, @NotEmpty, @NotBlank
            - @Email, @Size, @Min, @Max
            - @Pattern para expresiones regulares
            Usado en: RegisterRequest, DTOs de entrada
            Valida autom√°ticamente datos antes de procesarlos en controllers
        -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-validation</artifactId>
        </dependency>

        <!--
            üê¨ MYSQL CONNECTOR
            Driver JDBC para conectar con base de datos MySQL:
            - Permite a Hibernate/JPA comunicarse con MySQL
            - Scope runtime: solo se necesita en ejecuci√≥n, no en compilaci√≥n
            Configurado en application.properties (url, username, password)
        -->
        <dependency>
            <groupId>com.mysql</groupId>
            <artifactId>mysql-connector-j</artifactId>
            <scope>runtime</scope>
        </dependency>

        <!--
            üß™ H2 DATABASE (solo para tests)
            Base de datos en memoria para pruebas de integraci√≥n:
            - No requiere instalaci√≥n de MySQL para tests
            - Se crea y destruye autom√°ticamente en cada test
            - Permite ejecutar tests sin afectar la base de datos real
            Configurado en application-test.properties
        -->
        <dependency>
            <groupId>com.h2database</groupId>
            <artifactId>h2</artifactId>
            <scope>test</scope>
        </dependency>

        <!--
            üîÑ SPRING BOOT DEVTOOLS
            Herramientas de desarrollo para agilizar el trabajo:
            - Autorecarga autom√°tica al detectar cambios en el c√≥digo (hot reload)
            - Desactiva cach√© de plantillas para ver cambios inmediatos
            - Opcional: no se incluye en el JAR de producci√≥n
            - Scope runtime: solo activo durante desarrollo
        -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-devtools</artifactId>
            <scope>runtime</scope>
            <optional>true</optional>
        </dependency>

        <!--
            üó∫Ô∏è MAPSTRUCT
            Framework de mapeo de objetos con generaci√≥n de c√≥digo en compilaci√≥n:
            - Convierte autom√°ticamente Entity ‚Üí DTO y viceversa
            - Genera c√≥digo Java eficiente (no usa reflexi√≥n)
            - Evita c√≥digo boilerplate repetitivo
            Usado en: UsuarioMapper, EquipoMapper, EstadisticaMapper, etc.
            Se requiere mapstruct-processor en maven-compiler-plugin
        -->
        <dependency>
            <groupId>org.mapstruct</groupId>
            <artifactId>mapstruct</artifactId>
            <version>${mapstruct.version}</version>
        </dependency>

        <!--
            üß™ SPRING BOOT STARTER TEST
            Suite completa de testing para Spring Boot:
            - JUnit 5 para escribir y ejecutar tests
            - Mockito para crear mocks de dependencias
            - AssertJ para aserciones fluidas
            - Spring Test para tests de integraci√≥n con contexto
            - @SpringBootTest, @WebMvcTest, @DataJpaTest
            Scope test: solo disponible en tests, no en producci√≥n
        -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-test</artifactId>
            <scope>test</scope>
        </dependency>

        <!--
            üîí SPRING SECURITY TEST
            Utilidades para testear funcionalidad de seguridad:
            - @WithMockUser para simular usuarios autenticados en tests
            - MockMvc configurado con Spring Security
            - Pruebas de autorizaci√≥n y autenticaci√≥n
            Scope test: complementa spring-boot-starter-test
        -->
        <dependency>
            <groupId>org.springframework.security</groupId>
            <artifactId>spring-security-test</artifactId>
            <scope>test</scope>
        </dependency>

        <!--
            üõ°Ô∏è SPRING BOOT STARTER SECURITY
            Framework de seguridad para autenticaci√≥n y autorizaci√≥n:
            - Integraci√≥n con JWT para autenticaci√≥n stateless
            - Configuraci√≥n de filtros de seguridad (JwtAuthFilter)
            - @PreAuthorize para autorizaci√≥n basada en roles
            - BCryptPasswordEncoder para encriptar contrase√±as
            - Configuraci√≥n CORS para permitir peticiones desde frontend
            Configurado en: SecurityConfig, JwtAuthFilter, SecurityUtils
        -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-security</artifactId>
        </dependency>

        <!--
            üîë JJWT API
            API de Java para crear y validar tokens JWT:
            - Define interfaces para trabajar con JWT (JSON Web Tokens)
            - Genera tokens firmados con HS256 (HMAC-SHA256)
            - Extrae claims (email, rol, fecha de expiraci√≥n) de tokens
            Usado en: JwtUtil para generateToken() y extractUsername()
            Requiere jjwt-impl y jjwt-jackson para funcionar
        -->
        <dependency>
            <groupId>io.jsonwebtoken</groupId>
            <artifactId>jjwt-api</artifactId>
            <version>0.11.5</version>
        </dependency>

        <!--
            üîë JJWT IMPLEMENTATION
            Implementaci√≥n real de la API JJWT:
            - Contiene la l√≥gica de firma y validaci√≥n de tokens
            - Implementa los algoritmos criptogr√°ficos (HS256, RS256, etc.)
            - Scope runtime: solo necesario en ejecuci√≥n, no en compilaci√≥n
            Usado internamente por jjwt-api
        -->
        <dependency>
            <groupId>io.jsonwebtoken</groupId>
            <artifactId>jjwt-impl</artifactId>
            <version>0.11.5</version>
            <scope>runtime</scope>
        </dependency>

        <!--
            üîë JJWT JACKSON
            Integraci√≥n de JJWT con Jackson para serializaci√≥n JSON:
            - Convierte claims del token a/desde JSON usando Jackson
            - Maneja tipos complejos en el payload del JWT
            - Scope runtime: solo necesario en ejecuci√≥n
            Permite incluir objetos complejos (roles, permisos) en el token
        -->
        <dependency>
            <groupId>io.jsonwebtoken</groupId>
            <artifactId>jjwt-jackson</artifactId>
            <version>0.11.5</version>
            <scope>runtime</scope>
        </dependency>

        <!--
            ‚òÅÔ∏è CLOUDINARY
            Servicio de almacenamiento en la nube para im√°genes:
            - Upload de im√°genes de perfil de jugadores/entrenadores
            - Redimensionamiento y optimizaci√≥n autom√°tica de im√°genes
            - CDN global para carga r√°pida de im√°genes
            - Transformaciones de imagen (recorte, formato, calidad)
            Configurado en: application.properties (cloud_name, api_key, api_secret)
            Usado en: UsuarioService para subir/actualizar fotos de perfil
        -->
        <dependency>
            <groupId>com.cloudinary</groupId>
            <artifactId>cloudinary-http44</artifactId>
            <version>1.38.0</version>
        </dependency>

    </dependencies>

    <!-- ===================== -->
    <!-- ‚öôÔ∏è PLUGINS -->
    <!-- ===================== -->
    <build>
        <plugins>
            <!--
                ‚öôÔ∏è MAVEN COMPILER PLUGIN
                Plugin de compilaci√≥n configurado para Java 21 y MapStruct:

                CONFIGURACI√ìN:
                - source/target: Java 21 (versi√≥n especificada en properties)

                ANNOTATION PROCESSOR PATHS:
                - mapstruct-processor: Procesador de anotaciones de MapStruct
                - Se ejecuta en tiempo de compilaci√≥n para generar implementaciones
                  de los mappers definidos con interfaces @Mapper
                - Genera c√≥digo Java en target/generated-sources/annotations

                COMPILER ARGS:
                - suppressGeneratorTimestamp=true: No incluye timestamp en c√≥digo generado
                  (√∫til para comparar c√≥digo generado en control de versiones)
                - implicit:none: Solo procesa archivos expl√≠citamente especificados

                RESULTADO:
                Convierte interfaces como UsuarioMapper en implementaciones concretas
                sin necesidad de escribir c√≥digo de mapeo manualmente.
            -->
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-compiler-plugin</artifactId>
                <version>3.11.0</version>
                <configuration>
                    <source>${java.version}</source>
                    <target>${java.version}</target>
                    <annotationProcessorPaths>
                        <path>
                            <groupId>org.mapstruct</groupId>
                            <artifactId>mapstruct-processor</artifactId>
                            <version>${mapstruct.version}</version>
                        </path>
                    </annotationProcessorPaths>
                    <compilerArgs>
                        <arg>-Amapstruct.suppressGeneratorTimestamp=true</arg>
                        <arg>-implicit:none</arg>
                    </compilerArgs>
                </configuration>
            </plugin>

            <!--
                üöÄ SPRING BOOT MAVEN PLUGIN
                Plugin oficial de Spring Boot para empaquetar y ejecutar la aplicaci√≥n:

                FUNCIONALIDADES:
                - Empaqueta la aplicaci√≥n en un JAR ejecutable aut√≥nomo
                - Incluye todas las dependencias en el JAR (fat JAR)
                - Permite ejecutar la app con: mvn spring-boot:run
                - Configura el classpath y el manifest del JAR
                - A√±ade el wrapper de Spring Boot para ejecutar con java -jar

                COMANDOS MAVEN √öTILES:
                - mvn spring-boot:run ‚Üí Ejecuta la aplicaci√≥n en desarrollo
                - mvn clean package ‚Üí Genera el JAR ejecutable en target/
                - java -jar target/api-0.0.1-SNAPSHOT.jar ‚Üí Ejecuta el JAR generado

                El JAR resultante incluye Tomcat embebido, por lo que no necesita
                servidor de aplicaciones externo para ejecutarse.
            -->
            <plugin>
                <groupId>org.springframework.boot</groupId>
                <artifactId>spring-boot-maven-plugin</artifactId>
            </plugin>
        </plugins>
    </build>

</project>